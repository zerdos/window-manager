!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self).WindowManager={})}(this,(function(t){"use strict";function i(t={}){const i=document.createElement(t.type||"div");return t.parent&&t.parent.appendChild(i),t.styles&&Object.assign(i.style,t.styles),t.className&&(i.className=t.className),t.html&&(i.innerHTML=t.html),i}var e=function(t,i,e){return t(e={path:i,exports:{},require:function(t,i){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==i&&e.path)}},e.exports),e.exports}((function(t){var i=Object.prototype.hasOwnProperty,e="~";function s(){}function o(t,i,e){this.fn=t,this.context=i,this.once=e||!1}function n(t,i,s,n,h){if("function"!=typeof s)throw new TypeError("The listener must be a function");var l=new o(s,n||t,h),r=e?e+i:i;return t._events[r]?t._events[r].fn?t._events[r]=[t._events[r],l]:t._events[r].push(l):(t._events[r]=l,t._eventsCount++),t}function h(t,i){0==--t._eventsCount?t._events=new s:delete t._events[i]}function l(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(e=!1)),l.prototype.eventNames=function(){var t,s,o=[];if(0===this._eventsCount)return o;for(s in t=this._events)i.call(t,s)&&o.push(e?s.slice(1):s);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},l.prototype.listeners=function(t){var i=e?e+t:t,s=this._events[i];if(!s)return[];if(s.fn)return[s.fn];for(var o=0,n=s.length,h=new Array(n);o<n;o++)h[o]=s[o].fn;return h},l.prototype.listenerCount=function(t){var i=e?e+t:t,s=this._events[i];return s?s.fn?1:s.length:0},l.prototype.emit=function(t,i,s,o,n,h){var l=e?e+t:t;if(!this._events[l])return!1;var r,a,d=this._events[l],c=arguments.length;if(d.fn){switch(d.once&&this.removeListener(t,d.fn,void 0,!0),c){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,i),!0;case 3:return d.fn.call(d.context,i,s),!0;case 4:return d.fn.call(d.context,i,s,o),!0;case 5:return d.fn.call(d.context,i,s,o,n),!0;case 6:return d.fn.call(d.context,i,s,o,n,h),!0}for(a=1,r=new Array(c-1);a<c;a++)r[a-1]=arguments[a];d.fn.apply(d.context,r)}else{var p,u=d.length;for(a=0;a<u;a++)switch(d[a].once&&this.removeListener(t,d[a].fn,void 0,!0),c){case 1:d[a].fn.call(d[a].context);break;case 2:d[a].fn.call(d[a].context,i);break;case 3:d[a].fn.call(d[a].context,i,s);break;case 4:d[a].fn.call(d[a].context,i,s,o);break;default:if(!r)for(p=1,r=new Array(c-1);p<c;p++)r[p-1]=arguments[p];d[a].fn.apply(d[a].context,r)}}return!0},l.prototype.on=function(t,i,e){return n(this,t,i,e,!1)},l.prototype.once=function(t,i,e){return n(this,t,i,e,!0)},l.prototype.removeListener=function(t,i,s,o){var n=e?e+t:t;if(!this._events[n])return this;if(!i)return h(this,n),this;var l=this._events[n];if(l.fn)l.fn!==i||o&&!l.once||s&&l.context!==s||h(this,n);else{for(var r=0,a=[],d=l.length;r<d;r++)(l[r].fn!==i||o&&!l[r].once||s&&l[r].context!==s)&&a.push(l[r]);a.length?this._events[n]=1===a.length?a[0]:a:h(this,n)}return this},l.prototype.removeAllListeners=function(t){var i;return t?(i=e?e+t:t,this._events[i]&&h(this,i)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=e,l.EventEmitter=l,t.exports=l}));const s={threshold:10,clicked:!0,doubleClicked:!1,doubleClickedTime:300,longClicked:!1,longClickedTime:500,capture:!1,clickDown:!1};function o(t,i,e){return new n(t,i,e)}class n{constructor(t,i,e){"string"!=typeof t||(t=document.querySelector(t))?(this.options=Object.assign({},s,e),this.events={mousedown:t=>this.mousedown(t),mouseup:t=>this.mouseup(t),mousemove:t=>this.mousemove(t),touchstart:t=>this.touchstart(t),touchmove:t=>this.touchmove(t),touchcancel:t=>this.cancel(t),touchend:t=>this.touchend(t)},t.addEventListener("mousedown",this.events.mousedown,{capture:this.options.capture}),t.addEventListener("mouseup",this.events.mouseup,{capture:this.options.capture}),t.addEventListener("mousemove",this.events.mousemove,{capture:this.options.capture}),t.addEventListener("touchstart",this.events.touchstart,{passive:!0,capture:this.options.capture}),t.addEventListener("touchmove",this.events.touchmove,{passive:!0,capture:this.options.capture}),t.addEventListener("touchcancel",this.events.touchcancel,{capture:this.options.capture}),t.addEventListener("touchend",this.events.touchend,{capture:this.options.capture}),this.element=t,this.callback=i):console.warn(`Unknown element: document.querySelector(${t}) in clicked()`)}destroy(){this.element.removeEventListener("mousedown",this.events.mousedown),this.element.removeEventListener("mouseup",this.events.mouseup),this.element.removeEventListener("mousemove",this.events.mousemove),this.element.removeEventListener("touchstart",this.events.touchstart,{passive:!0}),this.element.removeEventListener("touchmove",this.events.touchmove,{passive:!0}),this.element.removeEventListener("touchcancel",this.events.touchcancel),this.element.removeEventListener("touchend",this.events.touchend)}touchstart(t){!0===this.down?this.cancel():1===t.touches.length&&this.handleDown(t.changedTouches[0].screenX,t.changedTouches[0].screenY)}pastThreshold(t,i){return Math.abs(this.lastX-t)>this.options.threshold||Math.abs(this.lastY-i)>this.options.threshold}touchmove(t){if(this.down)if(1!==t.touches.length)this.cancel();else{const i=t.changedTouches[0].screenX,e=t.changedTouches[0].screenY;this.pastThreshold(i,e)&&this.cancel()}}cancel(){this.down=!1,this.doubleClickedTimeout&&(clearTimeout(this.doubleClickedTimeout),this.doubleClickedTimeout=null),this.longClickedTimeout&&(clearTimeout(this.longClickedTimeout),this.longClickedTimeout=null)}touchend(t){this.down&&(t.preventDefault(),this.handleClicks(t,t.pointerId))}handleClicks(t){this.options.doubleClicked?this.doubleClickedTimeout=setTimeout(()=>this.doubleClickedCancel(t),this.options.doubleClickedTime):this.options.clicked&&this.callback({event:t,type:"clicked"}),this.longClickedTimeout&&(clearTimeout(this.longClickedTimeout),this.longClickedTimeout=null),this.down=!1}handleDown(t,i,e){this.doubleClickedTimeout?this.pastThreshold(i,e)?(this.options.clicked&&this.callback({event:t,type:"clicked"}),this.cancel()):(this.callback({event:t,type:"double-clicked"}),this.cancel()):(this.lastX=i,this.lastY=e,this.down=!0,this.options.longClicked&&(this.longClickedTimeout=setTimeout(()=>this.longClicked(t),this.options.longClickedTime)),this.options.clickDown&&this.callback({event:t,type:"click-down"}))}longClicked(t){this.longClikedTimeout=null,this.down=!1,this.callback({event:t,type:"long-clicked"})}doubleClickedCancel(t){this.doubleClickedTimeout=null,this.options.clicked&&this.callback({event:t,type:"double-clicked"})}mousedown(t){!0===this.down?this.down=!1:this.handleDown(t,t.screenX,t.screenY)}mousemove(t){if(this.down){const i=t.screenX,e=t.screenY;this.pastThreshold(i,e)&&this.cancel()}}mouseup(t){this.down&&(t.preventDefault(),this.handleClicks(t))}}class h extends e{constructor(t,i={}){super(),this.wm=t,this.options=i,this.id=void 0===this.options.id?h.id++:this.options.id,this._createWindow(),this._listeners(),this.active=!1,this.maximized=!1,this._closed=!0,this._restore=null,this._moving=null,this._resizing=null,this._attachedToScreen={vertical:"",horziontal:""}}open(t){this._closed&&(this.win.style.display="block",this._closed=!1,this.emit("open",this),t||this.focus())}focus(){this.active=!0,this.options.titlebar&&(this.winTitlebar.style.backgroundColor=this.options.backgroundTitlebarActive),this.emit("focus",this)}blur(){this.active=!1,this.options.titlebar&&(this.winTitlebar.style.backgroundColor=this.options.backgroundTitlebarInactive),this.emit("blur",this)}close(){this._closed||(this._closed=!0,this.win.style.display="none",this.emit("close",this))}get closed(){return this._closed}get x(){return this.options.x}set x(t){t!==this.options.x&&(this.options.x=t,this.emit("move-x",this),this._buildTransform())}_buildTransform(){this.win.style.transform=`translate(${this.options.x}px,${this.options.y}px)`}get y(){return this.options.y}set y(t){t!==this.options.y&&(this.options.y=t,this._buildTransform(),this.emit("move-y",this))}get width(){return this.options.width||this.win.offsetWidth}set width(t){t!==this.options.width&&(t?(this.win.style.width=t+"px",this.options.width=this.win.offsetWidth):(this.win.style.width="auto",this.options.width=""),this.emit("resize-width",this))}get height(){return this.options.height||this.win.offsetHeight}set height(t){t!==this.options.height&&(t?(this.win.style.height=t+"px",this.options.height=this.win.offsetHeight):(this.win.style.height="auto",this.options.height=""),this.emit("resize-height",this))}resize(t,i){this.width=t,this.height=i}move(t,i){const e=this.keepInside;if(e){const s=this.bounds;!0!==e&&"horizontal"!==e||(t=(t=t+this.width>s.right?s.right-this.width:t)<s.left?s.left:t),!0!==e&&"vertical"!==e||(i=(i=i+this.height>s.bottom?s.bottom-this.height:i)<s.top?s.top:i)}t!==this.options.x&&(this.options.x=t,this.emit("move-x",this)),i!==this.options.y&&(this.options.y=i,this.emit("move-y",this)),this._buildTransform()}maximize(){if(this.options.maximizable)if(this.maximized)this.x=this.maximized.x,this.y=this.maximized.y,this.width=this.maximized.width,this.height=this.maximized.height,this.maximized=null,this.emit("restore",this),this.buttons.maximize.innerHTML=this.options.maximizeButton;else{const t=this.x,i=this.y,e=this.win.offsetWidth,s=this.win.offsetHeight;this.maximized={x:t,y:i,width:e,height:s},this.x=0,this.y=0,this.width=this.wm.overlay.offsetWidth,this.height=this.wm.overlay.offsetHeight,this.emit("maximize",this),this.buttons.maximize.innerHTML=this.options.restoreButton}}sendToBack(){this.wm.sendToBack(this)}sendToFront(){this.wm.sendToFront(this)}save(){const t={},i=this.maximized;return i&&(t.maximized={left:i.left,top:i.top,width:i.width,height:i.height}),t.x=this.x,t.y=this.y,void 0!==this.options.width&&(t.width=this.options.width),void 0!==this.options.height&&(t.height=this.options.height),t.closed=this._closed,t}load(t){t.maximized?this.maximized||this.maximize(!0):this.maximized&&this.maximize(!0),this.x=t.x,this.y=t.y,void 0!==t.width?this.width=t.width:this.win.style.width="auto",void 0!==t.height?this.height=t.height:this.win.style.height="auto",t.closed?this.close(!0):this.closed&&this.open(!0,!0)}get title(){return this._title}set title(t){this.winTitle.innerText=t,this.emit("title-change",this)}get right(){return this.x+this.width}set right(t){this.x=t-this.width}get bottom(){return this.y+this.height}set bottom(t){this.y=t-this.height}center(t){t?this.move(t.x+t.width/2-this.width/2,t.y+t.height/2-this.height/2):this.move(window.innerWidth/2-this.width/2,window.innerHeight/2-this.height/2)}_createWindow(){this.win=i({parent:this.wm?this.wm.win:null,styles:{display:"none","border-radius":this.options.borderRadius,"user-select":"none",overflow:"hidden",position:"absolute","min-width":this.options.minWidth,"min-height":this.options.minHeight,"box-shadow":this.options.shadow,"background-color":this.options.backgroundWindow,width:isNaN(this.options.width)?this.options.width:this.options.width+"px",height:isNaN(this.options.height)?this.options.height:this.options.height+"px",...this.options.styles},className:this.options.classNames.win}),this.winBox=i({parent:this.win,styles:{display:"flex","flex-direction":"column",width:"100%",height:"100%","min-height":this.options.minHeight},className:this.options.classNames.winBox}),this._createTitlebar(),this.content=i({parent:this.winBox,type:"section",styles:{display:"block",flex:1,"min-height":this.minHeight,"overflow-x":"hidden","overflow-y":"auto"},className:this.options.classNames.content}),this.options.resizable&&this._createResize(),this.overlay=i({parent:this.win,styles:{display:"none",position:"absolute",left:0,top:0,width:"100%",height:"100%"},className:this.options.classNames.overlay}),this.overlay.addEventListener("mousedown",t=>{this._downTitlebar(t),t.stopPropagation()}),this.overlay.addEventListener("touchstart",t=>{this._downTitlebar(t),t.stopPropagation()}),this._buildTransform()}_downTitlebar(t){const i=this._convertMoveEvent(t);this._moving={x:i.pageX-this.x,y:i.pageY-this.y},this.emit("move-start",this),this._moved=!1}_createTitlebar(){if(this.options.titlebar){this.winTitlebar=i({parent:this.winBox,type:"header",styles:{"user-select":"none",display:"flex","flex-direction":"row","align-items":"center","justify-content":"center",height:this.options.titlebarHeight,"min-height":this.options.titlebarHeight,border:0,padding:"0 8px",overflow:"hidden"},className:this.options.classNames.titlebar});const t={"user-select":"none",flex:1,display:"flex","flex-direction":"row","align-items":"center","user-select":"none",cursor:"default",padding:0,margin:0,"font-size":"16px","font-weight":400,color:this.options.foregroundTitle};this.options.titleCenter?t["justify-content"]="center":t["padding-left"]="8px",this.winTitle=i({parent:this.winTitlebar,type:"span",html:this.options.title,styles:t,className:this.options.classNames.winTitle}),this._createButtons(),this.options.movable&&(this.winTitlebar.addEventListener("mousedown",t=>this._downTitlebar(t)),this.winTitlebar.addEventListener("touchstart",t=>this._downTitlebar(t))),this.options.maximizable&&o(this.winTitlebar,()=>this.maximize(),{doubleClicked:!0,clicked:!1})}}_createButtons(){this.winButtonGroup=i({parent:this.winTitlebar,styles:{display:"flex","flex-direction":"row","align-items":"center","padding-left":"10px"},className:this.options.classNames.winButtonGroup});const t={display:"inline-block",border:0,margin:0,"margin-left":"15px",padding:0,width:"12px",height:"12px","background-color":"transparent","background-size":"cover","background-repeat":"no-repeat",opacity:.7,color:this.options.foregroundButton,outline:0};this.buttons={},this.options.maximizable&&(this.buttons.maximize=i({parent:this.winButtonGroup,html:this.options.maximizeButton,type:"button",styles:t,className:this.options.maximize}),o(this.buttons.maximize,()=>this.maximize())),this.options.closable&&(this.buttons.close=i({parent:this.winButtonGroup,html:this.options.closeButton,type:"button",styles:t,className:this.options.close}),o(this.buttons.close,()=>this.close()));for(let t in this.buttons){const i=this.buttons[t];i.addEventListener("mousemove",()=>{i.style.opacity=1}),i.addEventListener("mouseout",()=>{i.style.opacity=.7})}}_createResize(){this.resizeEdge=i({parent:this.winBox,type:"button",html:this.options.backgroundResize,styles:{position:"absolute",bottom:0,right:"4px",border:0,margin:0,padding:0,cursor:"se-resize","user-select":"none",height:"15px",width:"10px",background:"none"},className:this.options.classNames.resizeEdge});const t=t=>{const i=this._convertMoveEvent(t),e=this.width||this.win.offsetWidth,s=this.height||this.win.offsetHeight;this._resizing={width:e-i.pageX,height:s-i.pageY},this.emit("resize-start"),t.preventDefault()};this.resizeEdge.addEventListener("mousedown",t),this.resizeEdge.addEventListener("touchstart",t)}_move(t){const i=this._convertMoveEvent(t);this._isTouchEvent(t)||1===t.which||(this._moving&&this._stopMove(),this._resizing&&this._stopResize()),this._moving&&(this.move(i.pageX-this._moving.x,i.pageY-this._moving.y),this.emit("move",this),t.preventDefault()),this._resizing&&(this.resize(i.pageX+this._resizing.width,i.pageY+this._resizing.height),this.maximized=null,this.emit("resize",this),t.preventDefault())}_up(){this._moving&&this._stopMove(),this._resizing&&this._stopResize()}_listeners(){this.win.addEventListener("mousedown",()=>this.focus()),this.win.addEventListener("touchstart",()=>this.focus())}_stopMove(){this._moving=null,this.emit("move-end",this)}_stopResize(){this._restore=this._resizing=null,this.emit("resize-end",this)}_isTouchEvent(t){return!!window.TouchEvent&&t instanceof window.TouchEvent}_convertMoveEvent(t){return this._isTouchEvent(t)?t.changedTouches[0]:t}attachToScreen(t,i){this._attachedToScreen[t]=i}resizePlacement(t,i){this.bounds=t,this.keepInside=i;let e=this.x,s=this.y;e="right"===this._attachedToScreen.horziontal?t.right-this.width:e,e="left"===this._attachedToScreen.horizontal?t.left:e,s="bottom"===this._attachedToScreen.vertical?t.bottom-this.height:s,s="top"===this._attachedToScreen.vertical?t.top:s,this.move(e,s)}isModal(t){return(t||!this._closed)&&this.options.modal}isClosed(){return this._closed}get z(){return parseInt(this.win.style.zIndex)}set z(t){this.win.style.zIndex=t}}h.id=0;const l={x:0,y:0,width:void 0,height:void 0,modal:!1,openOnCreate:!0,classNames:{},minWidth:"200px",minHeight:"60px",borderRadius:0,styles:{},shadow:"none",movable:!0,resizable:!0,maximizable:!0,closable:!0,titlebar:!0,titlebarHeight:"2rem",backgroundModal:"rgba(0, 0, 0, 0.6)",backgroundWindow:"#fefefe",backgroundTitlebarActive:"#365d98",backgroundTitlebarInactive:"#888888",foregroundButton:"#ffffff",foregroundTitle:"#ffffff",closeButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="close" x="0" y="0" width="20" height="20" style="fill:none;"/><g><path d="M3.5,3.5l13,13" style="fill:none;stroke:#fff;stroke-width:3px;"/><path d="M16.5,3.5l-13,13" style="fill:none;stroke:#fff;stroke-width:3px;"/></g></svg>',maximizeButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="maximize" x="0" y="0" width="20" height="20" style="fill:none;"/><rect x="2" y="2" width="16" height="16" style="fill:none;stroke:#fff;stroke-width:2px;"/><rect x="2" y="2" width="16" height="3.2" style="fill:#fff;"/></svg>',restoreButton:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;"><rect id="restore" x="0" y="0" width="20" height="20" style="fill:none;"/><g><rect x="7" y="2.5" width="10" height="10" style="fill:none;stroke:#fff;stroke-width:1.5px;"/><rect x="7" y="2.5" width="10" height="2" style="fill:#fff;"/></g><g><rect x="3" y="7.5" width="10" height="10" style="fill:none;stroke:#fff;stroke-width:1.5px;"/><g><rect x="3" y="7.5" width="10" height="2" style="fill:#fff;"/></g></g></svg>',backgroundResize:'<?xml version="1.0" encoding="UTF-8" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg width="100%" height="100%" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><rect id="resize" x="0" y="0" width="20" height="20" style="fill:none;"/><clipPath id="_clip1"><rect x="0" y="0" width="20" height="20"/></clipPath><g clip-path="url(#_clip1)"><rect x="0" y="16.8" width="20" height="3.2" style="fill:#fff;"/><path d="M17.737,3.595l-14.142,14.142l2.263,2.263l14.142,-14.142l-2.263,-2.263Z" style="fill:#fff;"/><path d="M16.8,0l0,20l3.2,0l0,-20l-3.2,0Z" style="fill:#fff;"/><path d="M7.099,18.4l11.301,-11.123l0,11.123l-11.301,0Z" style="fill:#fff;"/></g></svg>'},r={screen:!0,windows:!0,snap:20,color:"#a8f0f4",spacing:5,indicator:10};class a{constructor(t,e={}){this.wm=t,this.options=Object.assign({},r,e),this.highlights=i({parent:this.wm.overlay,styles:{position:"absolute"}}),this.horizontal=i({parent:this.highlights,styles:{display:"none",position:"absolute",height:this.options.indicator+"px",borderRadius:this.options.indicator+"px",backgroundColor:this.options.color}}),this.vertical=i({parent:this.highlights,styles:{display:"none",position:"absolute",width:this.options.indicator+"px",borderRadius:this.options.indicator+"px",backgroundColor:this.options.color}}),this.horizontal,this.showing=[]}stop(){this.highlights.remove(),this.stopped=!0}addWindow(t){t.on("move",()=>this.move(t)),t.on("move-end",()=>this.moveEnd(t))}screenMove(t,i,e){const s=document.body.clientWidth,o=document.body.clientHeight;t.left-this.options.snap<=s&&t.right+this.options.snap>=0&&(Math.abs(t.top-0)<=this.options.snap?i.push({distance:Math.abs(t.top-0),left:0,width:s,top:0,side:"top",screen:!0}):Math.abs(t.bottom-o)<=this.options.snap&&i.push({distance:Math.abs(t.bottom-o),left:0,width:s,top:o,side:"bottom",screen:!0})),t.top-this.options.snap<=o&&t.bottom+this.options.snap>=0&&(Math.abs(t.left-0)<=this.options.snap?e.push({distance:Math.abs(t.left-0),top:0,height:o,left:0,side:"left",screen:!0}):Math.abs(t.right-s)<=this.options.snap&&e.push({distance:Math.abs(t.right-s),top:0,height:o,left:s,side:"right",screen:!0}))}windowsMove(t,i,e,s){for(let o of this.wm.windows)if(!o.options.noSnap&&o!==t){const t=o.win.getBoundingClientRect();i.left-this.options.snap<=t.right&&i.right+this.options.snap>=t.left&&(Math.abs(i.top-t.bottom)<=this.options.snap?(e.push({distance:Math.abs(i.top-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"top"}),Math.abs(i.left-t.left)<=this.options.snap?s.push({distance:Math.abs(i.left-t.left),top:t.top,height:t.height,left:t.left,side:"left",noSpacing:!0}):Math.abs(i.right-t.right)<=this.options.snap&&s.push({distance:Math.abs(i.right-t.right),top:t.top,height:t.height,left:t.right,side:"right",noSpacing:!0})):Math.abs(i.bottom-t.top)<=this.options.snap&&(e.push({distance:Math.abs(i.bottom-t.top),left:t.left,width:t.width,top:t.top,side:"bottom"}),Math.abs(i.left-t.left)<=this.options.snap?s.push({distance:Math.abs(i.left-t.left),top:t.top,height:t.height,left:t.left,side:"left",noSpacing:!0}):Math.abs(i.right-t.right)<=this.options.snap&&s.push({distance:Math.abs(i.right-t.right),top:t.top,height:t.height,left:t.right,side:"right",noSpacing:!0}))),i.top-this.options.snap<=t.bottom&&i.bottom+this.options.snap>=t.top&&(Math.abs(i.left-t.right)<=this.options.snap?(s.push({distance:Math.abs(i.left-t.right),top:t.top,height:t.height,left:t.right,side:"left"}),Math.abs(i.top-t.top)<=this.options.snap?e.push({distance:Math.abs(i.top-t.top),left:t.left,width:t.width,top:t.top,side:"top",noSpacing:!0}):Math.abs(i.bottom-t.bottom)<=this.options.snap&&e.push({distance:Math.abs(i.bottom-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"bottom",noSpacing:!0})):Math.abs(i.right-t.left)<=this.options.snap&&(s.push({distance:Math.abs(i.right-t.left),top:t.top,height:t.height,left:t.left,side:"right"}),Math.abs(i.top-t.top)<=this.options.snap?e.push({distance:Math.abs(i.top-t.top),left:t.left,width:t.width,top:t.top,side:"top",noSpacing:!0}):Math.abs(i.bottom-t.bottom)<=this.options.snap&&e.push({distance:Math.abs(i.bottom-t.bottom),left:t.left,width:t.width,top:t.bottom,side:"bottom",noSpacing:!0})))}}move(t){if(this.stopped||t.options.noSnap||t.isModal())return;this.horizontal.style.display="none",this.vertical.style.display="none";const i=[],e=[],s=t.win.getBoundingClientRect();if(this.options.screen&&this.screenMove(s,i,e),this.options.windows&&this.windowsMove(t,s,i,e),i.length){i.sort((t,i)=>t.distance-i.distance);const t=i[0];this.horizontal.style.display="block",this.horizontal.style.width=t.width+"px",this.horizontal.y=t.top-this.options.indicator/2,this.horizontal.style.transform=`translate(${t.left}px,${this.horizontal.y}px)`,this.horizontal.side=t.side,this.horizontal.noSpacing=t.noSpacing,this.horizontal.screen=t.screen}if(e.length){e.sort((t,i)=>t.distance-i.distance);const t=e[0];this.vertical.style.display="block",this.vertical.style.height=t.height+"px",this.vertical.x=t.left-this.options.indicator/2,this.vertical.style.transform=`translate(${this.vertical.x}px,${t.top}px)`,this.vertical.side=t.side,this.vertical.noSpacing=t.noSpacing,this.vertical.screen=t.screen}}moveEnd(t){if(!this.stopped){if("block"===this.horizontal.style.display){const i=this.horizontal.noSpacing?0:this.options.spacing,e=t.minimized?(t.height-t.height*t.minimized.scaleY)/2:0;switch(this.horizontal.side){case"top":t.y=this.horizontal.y-e+i+this.options.indicator/2;break;case"bottom":t.bottom=Math.floor(this.horizontal.y+e-i+this.options.indicator/2)}t.attachToScreen("vertical",this.horizontal.screen?this.horizontal.side:"")}if("block"===this.vertical.style.display){const i=this.vertical.noSpacing?0:this.options.spacing,e=t.minimized?(t.width-t.width*t.minimized.scaleX)/2:0;switch(this.vertical.side){case"left":t.x=this.vertical.x-e+i+this.options.indicator/2;break;case"right":t.right=Math.floor(this.vertical.x+e-i+this.options.indicator/2)}t.attachToScreen("horziontal",this.vertical.screen?this.vertical.side:"")}this.horizontal.style.display=this.vertical.style.display="none"}}}const d={parent:document.body,quiet:!1,keepInside:!0,snap:!0};t.Window=h,t.WindowManager=class{constructor(t={},i={}){this.windows=[],this.active=null,this.options=Object.assign({},d,t),this.defaultOptions=Object.assign({},l,i),this.options.quiet||console.log("%c ☕ simple-window-manager initialized ☕","color: #ff00ff"),this._createDom(t.parent||document.body),this.options.snap&&this.snap(!0===this.options.snap?{}:this.options.snap),window.addEventListener("resize",()=>this.resize())}createWindow(t={}){const i=new h(this,Object.assign({},this.defaultOptions,t));return i.on("open",()=>this._open(i)),i.on("focus",()=>this._focus(i)),i.on("blur",()=>this._blur(i)),i.on("close",()=>this._close(i)),i.win.addEventListener("mousemove",t=>this._move(t)),i.win.addEventListener("touchmove",t=>this._move(t)),i.win.addEventListener("mouseup",t=>this._up(t)),i.win.addEventListener("touchend",t=>this._up(t)),this._snap&&!t.noSnap&&this._snap.addWindow(i),i.resizePlacement(this.bounds,this.options.keepInside),i.options.openOnCreate&&i.open(),i}attachWindow(t){return t.on("open",this._open,this),t.on("focus",this._focus,this),t.on("blur",this._blur,this),t.on("close",this._close,this),this.win.appendChild(t.win),t.wm=this,t.win.addEventListener("mousemove",t=>this._move(t)),t.win.addEventListener("touchmove",t=>this._move(t)),t.win.addEventListener("mouseup",t=>this._up(t)),t.win.addEventListener("touchend",t=>this._up(t)),this._snap&&!this.defaultOptions.noSnap&&this._snap.addWindow(t),t}snap(t){this._snap=new a(this,t);for(let t of this.windows)t.options.noSnap||this._snap.addWindow(t)}sendToFront(t){const i=this.windows.indexOf(t);console.assert(-1!==i,"sendToFront should find window in this.windows"),i!==this.windows.length-1&&(this.windows.splice(i,1),this.windows.push(t),this._reorder())}sendToBack(t){const i=this.windows.indexOf(t);console.assert(-1!==i,"sendToFront should find window in this.windows"),0!==i&&(this.windows.splice(i,1),this.windows.unshift(t),this._reorder())}save(){const t={};for(let i=0;i<this.windows.length;i++){const e=this.windows[i];t[e.id]=e.save(),t[e.id].order=i}return t}load(t){for(let i=0;i<this.windows.length;i++){const e=this.windows[i];t[e.id]&&e.load(t[e.id])}}closeAll(){for(let t of this.windows)t.close();this.windows=[],this.active=null}_reorder(){let t=0;for(const i of this.windows)i.isClosed()||(i.z=t++)}_createDom(t){this.win=i({parent:t,styles:{"user-select":"none",width:"100%",height:"100%",overflow:"hidden","z-index":-1,cursor:"default"}}),this.overlay=i({parent:this.win,styles:{"user-select":"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden"}}),this.overlay.addEventListener("mousemove",t=>this._move(t)),this.overlay.addEventListener("touchmove",t=>this._move(t)),this.overlay.addEventListener("mouseup",t=>this._up(t)),this.overlay.addEventListener("touchend",t=>this._up(t)),this.modalOverlay=i({parent:this.win,styles:{display:"none","user-select":"none",position:"absolute",top:0,left:0,width:"100%",height:"100%",overflow:"hidden",background:this.defaultOptions.backgroundModal}}),this.modalOverlay.addEventListener("mousemove",t=>{this._move(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchmove",t=>{this._move(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("mouseup",t=>{this._up(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchend",t=>{this._up(t),t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation()}),this.modalOverlay.addEventListener("touchstart",t=>{t.preventDefault(),t.stopPropagation()})}_open(t){this.windows.push(t),this._reorder(),t.options.modal?(this.modalOverlay.style.display="block",this.modalOverlay.style.zIndex=t.z):this.modalOverlay.style.display="none"}_focus(t){if(this.active===t)return;this.active&&this.active.blur();const i=this.windows.indexOf(t);console.assert(-1!==i,"WindowManager._focus should find window in this.windows"),i!==this.windows.length-1&&(this.windows.splice(i,1),this.windows.push(t)),this._reorder(),this.active=this.windows[this.windows.length-1]}_blur(t){this.active===t&&(this.active=null)}_close(t){const i=this.windows.indexOf(t);console.assert(-1!==i,"WindowManager._close should find window in this.windows"),this.windows.splice(i,1);const e=this.windows[this.windows.length-1];t.isModal(!0)&&(e&&e.isModal()?this.modalOverlay.style.zIndex=e.z:this.modalOverlay.style.display="none"),e.focus()}_move(t){for(const i in this.windows)this.windows[i]._move(t)}_up(t){for(const i in this.windows)this.windows[i]._up(t)}checkModal(t){return!this.modal||this.modal===t}get bounds(){return{top:this.win.offsetTop,bottom:this.win.offsetTop+this.win.offsetHeight,left:this.win.offsetLeft,right:this.win.offsetLeft+this.win.offsetWidth}}resize(){const t=this.bounds;for(const i in this.windows)this.windows[i].resizePlacement(t,this.options.keepInside)}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=simple-window-manager.min.js.map
